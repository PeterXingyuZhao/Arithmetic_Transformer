# to edit: do an evaluation every {eval_interval} iterations
eval_interval = 100
eval_iters = 1
always_save_checkpoint = True


wandb_log = True # override via command line if you like
wandb_project = 'multiplication'

# to edit: wandb run name
wandb_run_name = '0_to_six_digit_times_1_digit_plain'

# baby GPT model :)
n_layer = 6
n_head = 6
n_embd = 384
dropout = 0.2

# to edit: 'plain' or 'reverse' or 'algo_reasoning'
data_format='plain'
operator='*'
dataset = 'bal'
batch_size = 512
block_size = 32 # context of up to 256 previous characters

# to edit: 'scratch' or 'resume', whether train from scratch or resume from a saved checkpoint
init_from = 'scratch'
# to edit: the checkpoint from which to resume training
ckpt_path_name = 'ckpt_2_operands_0_to_999_their_training_data_plain.pt'

# to edit: whether the result is reversed
reverse_c = False
eval_addition = True

analysis = False

# to edit: max number of digits in each operand
num_digit = 6

# to edit: maximum number of output tokens (including '$')
max_new_tokens = 8

# whether need zero‚Äêpadding
zero_pad = False

# ===== Learning Rate Policy ===== #
learning_rate = 1e-3

# to edit: the number of training iterations
max_iters = 5000
lr_decay_iters = 5000 # make equal to max_iters usually

beta1 = 0.9
beta2 = 0.98
warmup_iters = 100

# ===== Device ===== #
device='cuda:0'

# to edit: the output directory
out_dir = '/content/drive/MyDrive/addition/0_to_six_digit_times_1_digit/plain_out'

# to edit: training data
train_data_path = '/content/drive/MyDrive/addition/data/0_to_six_digit_times_1_digit/0_to_six_digit_times_1_digit_bal_train.txt'

# to edit: whether do evaluation on training data to see if the model is simply memorizing
eval_addition_train = True
start_train = "FILE:/content/drive/MyDrive/addition/data/0_to_six_digit_times_1_digit/0_to_six_digit_times_1_digit_bal_train_eval.txt"

# to edit: valuation data
val_data_path = '/content/drive/MyDrive/addition/data/0_to_six_digit_times_1_digit/0_to_six_digit_times_1_digit_bal_validation.txt'

# to edit: test data (start is just the test file)
start = 'FILE:/content/drive/MyDrive/addition/data/0_to_six_digit_times_1_digit/test/0_to_six_digit_times_1_digit_bal_test.txt'

# (optional param) to_edit: whether to enable detailed metric recording at each eval_interval
# test_dir: the directory storing test files
test_dir = '/content/drive/MyDrive/addition/data/0_to_six_digit_times_1_digit/test'
eval_additional_test = True  # whether to evaluate on additional test files 

# to edit: whether to do more frequenly evaluations in early stages
more_early_eval1 = True
early_eval_interval1 = 5
early_eval_iters1 = 1000

more_early_eval2 = False
early_eval_interval2 = 5
early_eval_iters2 = 750